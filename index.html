<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>🔥 لوحة تحكم التحول العضلي - أحمد الحديد السعيد</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap');
  
  :root {
    --primary: #d62828;
    --primary-dark: #a4161a;
    --secondary: #f77f00;
    --accent: #003049;
    --success: #06d6a0;
    --warning: #ffd60a;
    --danger: #e63946;
    --bg-light: #fafafa;
    --bg-dark: #1a1a1a;
    --surface-light: #ffffff;
    --surface-dark: #2d2d2d;
    --text-light: #333333;
    --text-dark: #ffffff;
    --text-muted: #666666;
    --border-light: #e0e0e0;
    --border-dark: #404040;
    --shadow: 0 4px 20px rgba(0,0,0,0.1);
    --shadow-dark: 0 4px 20px rgba(0,0,0,0.3);
    --gradient-primary: linear-gradient(135deg, var(--primary), var(--primary-dark));
    --gradient-secondary: linear-gradient(135deg, var(--secondary), #e76f00);
    --gradient-accent: linear-gradient(135deg, var(--accent), #004466);
    --border-radius: 12px;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Cairo', sans-serif;
    background: var(--bg-light);
    color: var(--text-light);
    line-height: 1.6;
    transition: var(--transition);
    padding: 20px;
    min-height: 100vh;
  }

  body.dark-mode {
    background: var(--bg-dark);
    color: var(--text-dark);
  }

  /* Header */
  .header {
    text-align: center;
    margin-bottom: 40px;
    position: relative;
  }

  .header h1 {
    font-size: 2.5rem;
    font-weight: 900;
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 10px;
    text-shadow: 0 2px 10px rgba(214, 40, 40, 0.3);
  }

  .header .subtitle {
    font-size: 1.1rem;
    color: var(--text-muted);
    font-weight: 400;
  }

  /* Dark Mode Toggle */
  .dark-mode-toggle {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 10px;
    background: var(--surface-light);
    padding: 10px 15px;
    border-radius: 25px;
    box-shadow: var(--shadow);
    cursor: pointer;
    transition: var(--transition);
    font-weight: 600;
  }

  body.dark-mode .dark-mode-toggle {
    background: var(--surface-dark);
    box-shadow: var(--shadow-dark);
  }

  .toggle-switch {
    position: relative;
    width: 50px;
    height: 25px;
    background: var(--border-light);
    border-radius: 25px;
    transition: var(--transition);
    cursor: pointer;
  }

  .toggle-switch.active {
    background: var(--gradient-primary);
  }

  .toggle-switch::before {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 21px;
    height: 21px;
    background: white;
    border-radius: 50%;
    transition: var(--transition);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }

  .toggle-switch.active::before {
    transform: translateX(25px);
  }

  /* Container */
  .container {
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Cards */
  .card {
    background: var(--surface-light);
    border-radius: var(--border-radius);
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: var(--shadow);
    transition: var(--transition);
    border: 1px solid var(--border-light);
  }

  body.dark-mode .card {
    background: var(--surface-dark);
    border-color: var(--border-dark);
    box-shadow: var(--shadow-dark);
  }

  .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(0,0,0,0.15);
  }

  .card-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid var(--border-light);
  }

  body.dark-mode .card-header {
    border-bottom-color: var(--border-dark);
  }

  .card-header h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent);
  }

  body.dark-mode .card-header h2 {
    color: var(--secondary);
  }

  /* Dashboard Stats */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }

  .stat-card {
    background: var(--gradient-primary);
    color: white;
    padding: 25px;
    border-radius: var(--border-radius);
    text-align: center;
    box-shadow: var(--shadow);
    transition: var(--transition);
    position: relative;
    overflow: hidden;
  }

  .stat-card::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -50%;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
    transform: rotate(45deg);
    transition: var(--transition);
  }

  .stat-card:hover::before {
    animation: shimmer 1s ease-in-out;
  }

  @keyframes shimmer {
    0% { transform: translateX(-100%) rotate(45deg); }
    100% { transform: translateX(200%) rotate(45deg); }
  }

  .stat-card:nth-child(2) {
    background: var(--gradient-secondary);
  }

  .stat-card:nth-child(3) {
    background: var(--gradient-accent);
  }

  .stat-card h3 {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 10px;
    opacity: 0.9;
  }

  .stat-card .value {
    font-size: 2rem;
    font-weight: 900;
    margin-bottom: 5px;
  }

  .stat-card .change {
    font-size: 0.8rem;
    opacity: 0.8;
  }

  /* Form Elements */
  .form-group {
    margin-bottom: 20px;
  }

  .form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    align-items: end;
  }

  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-light);
  }

  body.dark-mode label {
    color: var(--text-dark);
  }

  input, select, textarea {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid var(--border-light);
    border-radius: var(--border-radius);
    font-family: 'Cairo', sans-serif;
    font-size: 1rem;
    transition: var(--transition);
    background: var(--surface-light);
    color: var(--text-light);
  }

  body.dark-mode input,
  body.dark-mode select,
  body.dark-mode textarea {
    background: var(--surface-dark);
    border-color: var(--border-dark);
    color: var(--text-dark);
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(214, 40, 40, 0.1);
  }

  /* Buttons */
  .btn {
    padding: 12px 24px;
    border: none;
    border-radius: var(--border-radius);
    font-family: 'Cairo', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 8px;
    text-decoration: none;
    position: relative;
    overflow: hidden;
  }

  .btn-primary {
    background: var(--gradient-primary);
    color: white;
  }

  .btn-secondary {
    background: var(--gradient-secondary);
    color: white;
  }

  .btn-success {
    background: var(--success);
    color: white;
  }

  .btn-outline {
    background: transparent;
    border: 2px solid var(--primary);
    color: var(--primary);
  }

  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }

  .btn:active {
    transform: translateY(0);
  }

  /* Tables */
  .table-container {
    overflow-x: auto;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: var(--surface-light);
    border-radius: var(--border-radius);
    overflow: hidden;
  }

  body.dark-mode table {
    background: var(--surface-dark);
  }

  th, td {
    padding: 15px;
    text-align: center;
    border-bottom: 1px solid var(--border-light);
  }

  body.dark-mode th,
  body.dark-mode td {
    border-bottom-color: var(--border-dark);
  }

  th {
    background: var(--gradient-primary);
    color: white;
    font-weight: 700;
    position: sticky;
    top: 0;
    z-index: 10;
  }

  tr:hover {
    background: rgba(214, 40, 40, 0.05);
  }

  body.dark-mode tr:hover {
    background: rgba(214, 40, 40, 0.1);
  }

  /* Modal */
  .modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(5px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: var(--transition);
  }

  .modal.active {
    opacity: 1;
    visibility: visible;
  }

  .modal-content {
    background: var(--surface-light);
    padding: 30px;
    border-radius: var(--border-radius);
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: var(--shadow-dark);
    transform: scale(0.9);
    transition: var(--transition);
  }

  body.dark-mode .modal-content {
    background: var(--surface-dark);
  }

  .modal.active .modal-content {
    transform: scale(1);
  }

  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid var(--border-light);
  }

  body.dark-mode .modal-header {
    border-bottom-color: var(--border-dark);
  }

  .close-btn {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--text-muted);
    padding: 5px;
    border-radius: 50%;
    transition: var(--transition);
  }

  .close-btn:hover {
    background: var(--danger);
    color: white;
  }

  /* Timer */
  .timer-display {
    text-align: center;
    padding: 20px;
    background: var(--gradient-primary);
    color: white;
    border-radius: var(--border-radius);
    margin: 20px 0;
    font-size: 1.2rem;
    font-weight: 700;
  }

  .timer-display.finished {
    background: var(--success);
    animation: pulse 1s infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  /* Charts Container */
  .charts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
    margin-top: 30px;
  }

  .chart-container {
    background: var(--surface-light);
    padding: 20px;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
  }

  body.dark-mode .chart-container {
    background: var(--surface-dark);
  }

  /* Progress Indicators */
  .progress-bar {
    width: 100%;
    height: 8px;
    background: var(--border-light);
    border-radius: 4px;
    overflow: hidden;
    margin: 10px 0;
  }

  body.dark-mode .progress-bar {
    background: var(--border-dark);
  }

  .progress-fill {
    height: 100%;
    background: var(--gradient-primary);
    border-radius: 4px;
    transition: width 0.5s ease;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .container {
      padding: 0 10px;
    }
    
    .stats-grid {
      grid-template-columns: 1fr;
    }
    
    .form-row {
      grid-template-columns: 1fr;
    }
    
    .dark-mode-toggle {
      position: relative;
      margin-bottom: 20px;
    }
    
    .header h1 {
      font-size: 2rem;
    }
    
    .charts-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Utilities */
  .hidden { display: none !important; }
  .text-center { text-align: center; }
  .text-muted { color: var(--text-muted); }
  .mb-20 { margin-bottom: 20px; }
  .mt-20 { margin-top: 20px; }

  /* Custom Scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--bg-light);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark);
  }

  body.dark-mode ::-webkit-scrollbar-track {
    background: var(--bg-dark);
  }

  /* Animations */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .card {
    animation: fadeInUp 0.6s ease;
  }

  .card:nth-child(1) { animation-delay: 0.1s; }
  .card:nth-child(2) { animation-delay: 0.2s; }
  .card:nth-child(3) { animation-delay: 0.3s; }
  .card:nth-child(4) { animation-delay: 0.4s; }
</style>
</head>
<body>

<div class="dark-mode-toggle" onclick="toggleDarkMode()">
  <span>🌙</span>
  <div class="toggle-switch" id="toggleSwitch"></div>
  <span>🌞</span>
</div>

<div class="container">
  <header class="header">
    <h1>🔥 لوحة تحكم التحول العضلي</h1>
    <p class="subtitle">أحمد "الحديد" السعيد - رحلتك نحو القوة والعضلات</p>
  </header>

  <!-- Dashboard Stats -->
  <div class="stats-grid">
    <div class="stat-card">
      <h3>السعرات اليومية</h3>
      <div class="value" id="caloriesValue">--</div>
      <div class="change">كالوري</div>
    </div>
    <div class="stat-card">
      <h3>آخر وزن مسجل</h3>
      <div class="value" id="weightValue">--</div>
      <div class="change">كيلوجرام</div>
    </div>
    <div class="stat-card">
      <h3>آخر تمرين</h3>
      <div class="value" id="workoutValue">--</div>
      <div class="change">تم تسجيله</div>
    </div>
  </div>

  <!-- User Info Card -->
  <div class="card">
    <div class="card-header">
      <h2>👤 بياناتك الأساسية</h2>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label for="weight">الوزن (كجم)</label>
        <input type="number" id="weight" min="30" max="200" value="70" />
      </div>
      <div class="form-group">
        <label for="height">الطول (سم)</label>
        <input type="number" id="height" min="130" max="230" value="178" />
      </div>
      <div class="form-group">
        <label for="age">العمر</label>
        <input type="number" id="age" min="15" max="80" value="25" />
      </div>
      <div class="form-group">
        <button class="btn btn-primary" onclick="calculateMacros()">
          🧮 احسب السعرات والماكروز
        </button>
      </div>
    </div>
    <div id="macroResults" class="mt-20"></div>
  </div>

  <!-- Training Schedule -->
  <div class="card">
  <div class="card-header">
    <h2>🗓️ جدول التدريب الأسبوعي التفصيلي</h2>
  </div>
  <div class="table-container" style="overflow-x:auto;">
    <table>
      <thead>
        <tr>
          <th>اليوم</th>
          <th>المجموعات العضلية</th>
          <th>التمارين مع المجموعات × التكرارات</th>
          <th>المدة المقترحة</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>اليوم 1</td>
          <td>الصدر + الترايسبس</td>
          <td>
            <ul style="text-align: right; direction: rtl; padding-right: 15px; margin: 0;">
              <li>Push-Ups متنوعة: 4 مجموعات × 12-15 تكرار</li>
              <li>Dips: 3 مجموعات × 8-12 تكرار</li>
              <li>Diamond Push-ups: 3 مجموعات × 10-12 تكرار</li>
            </ul>
          </td>
          <td>45-60 دقيقة</td>
        </tr>
        <tr>
          <td>اليوم 2</td>
          <td>الظهر + البايسبس</td>
          <td>
            <ul style="text-align: right; direction: rtl; padding-right: 15px; margin: 0;">
              <li>Pull-ups: 4 مجموعات × 6-10 تكرار</li>
              <li>Body Rows: 3 مجموعات × 10-12 تكرار</li>
              <li>Towel Curls: 3 مجموعات × 12-15 تكرار</li>
            </ul>
          </td>
          <td>45-60 دقيقة</td>
        </tr>
        <tr>
          <td>اليوم 3</td>
          <td>الأرجل + الجلوتس</td>
          <td>
            <ul style="text-align: right; direction: rtl; padding-right: 15px; margin: 0;">
              <li>Squats: 4 مجموعات × 15-20 تكرار</li>
              <li>Lunges: 3 مجموعات × 12 تكرار لكل ساق</li>
              <li>Bulgarian Squats: 3 مجموعات × 10-12 تكرار لكل ساق</li>
              <li>Wall Sits: 3 مرات × 45-60 ثانية</li>
            </ul>
          </td>
          <td>50-70 دقيقة</td>
        </tr>
        <tr>
          <td>اليوم 4</td>
          <td>الأكتاف + الكور</td>
          <td>
            <ul style="text-align: right; direction: rtl; padding-right: 15px; margin: 0;">
              <li>Pike Push-ups: 4 مجموعات × 10-12 تكرار</li>
              <li>Handstand Hold (دعم الحائط إذا لزم الأمر): 3 مرات × 20-30 ثانية</li>
              <li>Plank Variations (بلانك عادي + بلانك جانبي): 3 مرات × 30-45 ثانية لكل نوع</li>
            </ul>
          </td>
          <td>40-55 دقيقة</td>
        </tr>
        <tr>
          <td>اليوم 5</td>
          <td>تمارين مركبة</td>
          <td>
            <ul style="text-align: right; direction: rtl; padding-right: 15px; margin: 0;">
              <li>Burpees: 4 مجموعات × 12-15 تكرار</li>
              <li>Mountain Climbers: 4 مجموعات × 30 ثانية بوتيرة عالية</li>
              <li>HIIT Circuit (تمرين دائري عالي الكثافة - مثل القفز، القرفصاء، الدفع): 20-25 دقيقة مع فترات راحة قصيرة</li>
            </ul>
          </td>
          <td>35-50 دقيقة</td>
        </tr>
        <tr>
          <td>اليوم 6</td>
          <td>استشفاء نشط</td>
          <td>
            <ul style="text-align: right; direction: rtl; padding-right: 15px; margin: 0;">
              <li>Yoga (تمارين اليوغا لزيادة المرونة): 30 دقيقة</li>
              <li>Stretching (تمارين التمدد لجميع العضلات): 15-20 دقيقة</li>
              <li>تمارين حركية خفيفة (مشي، حركة مفاصل): 15 دقيقة</li>
            </ul>
          </td>
          <td>30-45 دقيقة</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>


  <!-- Nutrition Plan -->
  <div class="card">
    <div class="card-header">
      <h2>🍽️ خطة التغذية المتقدمة</h2>
    </div>
    <div class="table-container">
      <table>
        <thead>
          <tr><th>الوجبة</th><th>المحتوى الغذائي</th><th>التوقيت المثالي</th><th>السعرات التقريبية</th></tr>
        </thead>
        <tbody>
          <tr><td>الإفطار</td><td>3 بيض + شوفان + موزة + زبدة لوز</td><td>خلال ساعة من الاستيقاظ</td><td>450-500 كالوري</td></tr>
          <tr><td>سناك صباحي</td><td>زبادي يوناني + عسل + توت</td><td>بعد 2-3 ساعات من الإفطار</td><td>200-250 كالوري</td></tr>
          <tr><td>الغداء</td><td>صدر دجاج + أرز بني + خضار مشكلة</td><td>منتصف اليوم</td><td>600-700 كالوري</td></tr>
          <tr><td>ما قبل التمرين</td><td>موزة + قهوة + حفنة تمر</td><td>30-60 دقيقة قبل التمرين</td><td>150-200 كالوري</td></tr>
          <tr><td>ما بعد التمرين</td><td>بروتين شيك + فاكهة</td><td>خلال 30 دقيقة من التمرين</td><td>250-300 كالوري</td></tr>
          <tr><td>العشاء</td><td>سمك + بطاطا حلوة + سلطة</td><td>قبل النوم بـ 2-3 ساعات</td><td>500-550 كالوري</td></tr>
        </tbody>
      </table>
    </div>
    
    <div class="text-center mt-20">
      <button class="btn btn-success" onclick="startMealTimer()">
        ⏰ ابدأ مؤقت الوجبة القادمة (2 ساعة)
      </button>
    </div>
    <div id="mealTimerDisplay" class="hidden"></div>
  </div>

  <!-- Measurements Tracking -->
  <div class="card">
    <div class="card-header">
      <h2>📈 تتبع القياسات</h2>
      <button class="btn btn-primary" onclick="showMeasurementModal()">
        ➕ إضافة قياس جديد
      </button>
    </div>
    <div class="table-container">
      <table id="measurementsTable">
        <thead>
          <tr>
            <th>التاريخ</th>
            <th>الوزن (كجم)</th>
            <th>الذراع (سم)</th>
            <th>الصدر (سم)</th>
            <th>الخصر (سم)</th>
            <th>الفخذ (سم)</th>
            <th>دهون الجسم (%)</th>
            <th>الإجراءات</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Workout Log -->
  <div class="card">
    <div class="card-header">
      <h2>💪 سجل التمارين</h2>
      <button class="btn btn-secondary" onclick="showWorkoutModal()">
        ➕ إضافة تمرين
      </button>
    </div>
    <div class="table-container">
      <table id="workoutTable">
        <thead>
          <tr>
            <th>التاريخ</th>
            <th>التمرين</th>
            <th>العضلات</th>
            <th>المجموعات × التكرارات</th>
            <th>الشدة (RPE)</th>
            <th>المدة</th>
            <th>الملاحظات</th>
            <th>الإجراءات</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Progress Charts -->
  <div class="card">
    <div class="card-header">
      <h2>📊 الرسوم البيانية للتقدم</h2>
    </div>
    <div class="charts-grid">
      <div class="chart-container">
        <h3 class="text-center mb-20">تطور الوزن</h3>
        <canvas id="weightChart" height="200"></canvas>
      </div>
      <div class="chart-container">
        <h3 class="text-center mb-20">تطور محيط الذراع</h3>
        <canvas id="armChart" height="200"></canvas>
      </div>
      <div class="chart-container">
        <h3 class="text-center mb-20">تطور محيط الصدر</h3>
        <canvas id="chestChart" height="200"></canvas>
      </div>
    </div>
  </div>

  <!-- Supplements & Recovery -->
  <div class="card">
    <div class="card-header">
      <h2>💊 المكملات والاستشفاء</h2>
    </div>
    <div class="form-row">
      <div class="form-group">
        <h3>🥤 المكملات المنصوح بها:</h3>
        <ul style="text-align: right; padding-right: 20px;">
          <li><strong>بروتين مصل اللبن:</strong> 25-30جم بعد التمرين</li>
          <li><strong>الكرياتين:</strong> 5جم يومياً مع الماء</li>
          <li><strong>أوميغا-3:</strong> 1-2جم مع الطعام</li>
          <li><strong>فيتامين د:</strong> 2000-4000 وحدة دولية</li>
          <li><strong>الزنك والمغنيسيوم:</strong> قبل النوم</li>
        </ul>
      </div>
      <div class="form-group">
        <h3>😴 نصائح الاستشفاء:</h3>
        <ul style="text-align: right; padding-right: 20px;">
          <li>نوم 7-9 ساعات يومياً</li>
          <li>شرب 3-4 لتر ماء يومياً</li>
          <li>تمارين تمدد يومية</li>
          <li>يوم راحة كامل أسبوعياً</li>
          <li>تجنب التوتر والضغط</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Measurement Modal -->
<div id="measurementModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>إضافة قياس جديد</h3>
      <button class="close-btn" onclick="closeMeasurementModal()">&times;</button>
    </div>
    <form id="measurementForm">
      <div class="form-group">
        <label for="measurementDate">التاريخ</label>
        <input type="date" id="measurementDate" required />
      </div>
      <div class="form-group">
        <label for="measurementWeight">الوزن (كجم)</label>
        <input type="number" id="measurementWeight" min="30" max="200" step="0.1" required />
      </div>
      <div class="form-group">
        <label for="measurementArm">محيط الذراع (سم)</label>
        <input type="number" id="measurementArm" min="10" max="80" step="0.1" required />
      </div>
      <div class="form-group">
        <label for="measurementChest">محيط الصدر (سم)</label>
        <input type="number" id="measurementChest" min="50" max="150" step="0.1" required />
      </div>
      <div class="form-group">
        <label for="measurementWaist">الخصر (سم)</label>
        <input type="number" id="measurementWaist" min="40" max="150" step="0.1" required />
      </div>
      <div class="form-group">
        <label for="measurementThigh">محيط الفخذ (سم)</label>
        <input type="number" id="measurementThigh" min="30" max="100" step="0.1" required />
      </div>
      <div class="form-group">
        <label for="measurementBodyFat">دهون الجسم (%)</label>
        <input type="number" id="measurementBodyFat" min="5" max="60" step="0.1" required />
      </div>
      <div class="form-group text-center">
        <button type="submit" class="btn btn-primary">حفظ القياس</button>
        <button type="button" class="btn btn-outline" onclick="closeMeasurementModal()">إلغاء</button>
      </div>
    </form>
  </div>
</div>

<!-- Workout Modal -->
<div id="workoutModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>إضافة تمرين جديد</h3>
      <button class="close-btn" onclick="closeWorkoutModal()">&times;</button>
    </div>
    <form id="workoutForm">
      <div class="form-group">
        <label for="workoutDate">التاريخ</label>
        <input type="date" id="workoutDate" required />
      </div>
      <div class="form-group">
        <label for="workoutName">اسم التمرين</label>
        <input type="text" id="workoutName" placeholder="مثال: Push-Ups" required />
      </div>
      <div class="form-group">
        <label for="workoutMuscles">المجموعات العضلية</label>
        <input type="text" id="workoutMuscles" placeholder="مثال: الصدر، الترايسبس" required />
      </div>
      <div class="form-group">
        <label for="workoutSetsReps">المجموعات × التكرارات</label>
        <input type="text" id="workoutSetsReps" placeholder="مثال: 4 × 12" required />
      </div>
      <div class="form-group">
        <label for="workoutRPE">الشدة (RPE)</label>
        <input type="number" id="workoutRPE" min="1" max="10" step="0.1" required />
      </div>
      <div class="form-group">
        <label for="workoutDuration">المدة (دقائق)</label>
        <input type="number" id="workoutDuration" min="1" max="180" required />
      </div>
      <div class="form-group">
        <label for="workoutNotes">ملاحظات</label>
        <textarea id="workoutNotes" rows="3" placeholder="أضف ملاحظات إضافية..."></textarea>
      </div>
      <div class="form-group text-center">
        <button type="submit" class="btn btn-secondary">حفظ التمرين</button>
        <button type="button" class="btn btn-outline" onclick="closeWorkoutModal()">إلغاء</button>
      </div>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Dark Mode Toggle
  function toggleDarkMode() {
    const body = document.body;
    const toggleSwitch = document.getElementById('toggleSwitch');
    body.classList.toggle('dark-mode');
    toggleSwitch.classList.toggle('active');
    // Save preference
    if(body.classList.contains('dark-mode')) {
      localStorage.setItem('darkMode', 'enabled');
    } else {
      localStorage.setItem('darkMode', 'disabled');
    }
  }

  // Load dark mode preference on page load
  window.addEventListener('DOMContentLoaded', () => {
    if(localStorage.getItem('darkMode') === 'enabled') {
      document.body.classList.add('dark-mode');
      document.getElementById('toggleSwitch').classList.add('active');
    }
    loadMeasurements();
    loadWorkouts();
    renderCharts();
  });

  // Calculate Macros and Calories
  function calculateMacros() {
    const weight = +document.getElementById('weight').value;
    const height = +document.getElementById('height').value;
    const age = +document.getElementById('age').value;

    // Basal Metabolic Rate (Mifflin-St Jeor Equation) for men
    const bmr = 10 * weight + 6.25 * height - 5 * age + 5;
    // Assuming moderate activity level
    const calories = Math.round(bmr * 1.55);

    // Macros based on calories (example: 40% carbs, 30% protein, 30% fat)
    const carbs = Math.round((calories * 0.4) / 4);
    const protein = Math.round((calories * 0.3) / 4);
    const fat = Math.round((calories * 0.3) / 9);

    document.getElementById('caloriesValue').textContent = calories + " كالوري";
    document.getElementById('macroResults').innerHTML = `
      <p><strong>الكربوهيدرات:</strong> ${carbs} جم</p>
      <p><strong>البروتين:</strong> ${protein} جم</p>
      <p><strong>الدهون:</strong> ${fat} جم</p>
    `;
  }

  // Meal Timer
  let mealTimerInterval;
  function startMealTimer() {
    const display = document.getElementById('mealTimerDisplay');
    let timeLeft = 2 * 60 * 60; // 2 hours in seconds
    display.classList.remove('hidden');

    clearInterval(mealTimerInterval);
    updateMealTimer();

    mealTimerInterval = setInterval(() => {
      timeLeft--;
      updateMealTimer();

      if(timeLeft <= 0) {
        clearInterval(mealTimerInterval);
        display.textContent = "🍽️ حان وقت الوجبة القادمة!";
        display.classList.add('finished');
      }
    }, 1000);

    function updateMealTimer() {
      const hours = Math.floor(timeLeft / 3600);
      const minutes = Math.floor((timeLeft % 3600) / 60);
      const seconds = timeLeft % 60;
      display.textContent = `⏳ الوقت المتبقي للوجبة القادمة: ${hours.toString().padStart(2,'0')}:${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
      display.classList.remove('finished');
    }
  }

  // Measurement Modal Functions
  function showMeasurementModal() {
    document.getElementById('measurementModal').classList.add('active');
    document.getElementById('measurementForm').reset();
  }
  function closeMeasurementModal() {
    document.getElementById('measurementModal').classList.remove('active');
  }

  // Workout Modal Functions
  function showWorkoutModal() {
    document.getElementById('workoutModal').classList.add('active');
    document.getElementById('workoutForm').reset();
  }
  function closeWorkoutModal() {
    document.getElementById('workoutModal').classList.remove('active');
  }

  // Measurements Storage & Table Update
  function loadMeasurements() {
    const measurements = JSON.parse(localStorage.getItem('measurements') || '[]');
    const tbody = document.querySelector('#measurementsTable tbody');
    tbody.innerHTML = '';

    measurements.forEach((m, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${m.date}</td>
        <td>${m.weight}</td>
        <td>${m.arm}</td>
        <td>${m.chest}</td>
        <td>${m.waist}</td>
        <td>${m.thigh}</td>
        <td>${m.bodyFat}</td>
        <td>
          <button class="btn btn-outline" onclick="deleteMeasurement(${index})">حذف</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  function saveMeasurement(e) {
    e.preventDefault();
    const measurements = JSON.parse(localStorage.getItem('measurements') || '[]');

    const newMeasurement = {
      date: document.getElementById('measurementDate').value,
      weight: parseFloat(document.getElementById('measurementWeight').value),
      arm: parseFloat(document.getElementById('measurementArm').value),
      chest: parseFloat(document.getElementById('measurementChest').value),
      waist: parseFloat(document.getElementById('measurementWaist').value),
      thigh: parseFloat(document.getElementById('measurementThigh').value),
      bodyFat: parseFloat(document.getElementById('measurementBodyFat').value),
    };

    measurements.push(newMeasurement);
    localStorage.setItem('measurements', JSON.stringify(measurements));
    loadMeasurements();
    renderCharts();
    closeMeasurementModal();
  }

  function deleteMeasurement(index) {
    const measurements = JSON.parse(localStorage.getItem('measurements') || '[]');
    measurements.splice(index, 1);
    localStorage.setItem('measurements', JSON.stringify(measurements));
    loadMeasurements();
    renderCharts();
  }

  // Workouts Storage & Table Update
  function loadWorkouts() {
    const workouts = JSON.parse(localStorage.getItem('workouts') || '[]');
    const tbody = document.querySelector('#workoutTable tbody');
    tbody.innerHTML = '';

    workouts.forEach((w, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${w.date}</td>
        <td>${w.name}</td>
        <td>${w.muscles}</td>
        <td>${w.setsReps}</td>
        <td>${w.rpe}</td>
        <td>${w.duration} دقيقة</td>
        <td>${w.notes || ''}</td>
        <td>
          <button class="btn btn-outline" onclick="deleteWorkout(${index})">حذف</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  function saveWorkout(e) {
    e.preventDefault();
    const workouts = JSON.parse(localStorage.getItem('workouts') || '[]');

    const newWorkout = {
      date: document.getElementById('workoutDate').value,
      name: document.getElementById('workoutName').value.trim(),
      muscles: document.getElementById('workoutMuscles').value.trim(),
      setsReps: document.getElementById('workoutSetsReps').value.trim(),
      rpe: parseFloat(document.getElementById('workoutRPE').value),
      duration: parseInt(document.getElementById('workoutDuration').value),
      notes: document.getElementById('workoutNotes').value.trim(),
    };

    workouts.push(newWorkout);
    localStorage.setItem('workouts', JSON.stringify(workouts));
    loadWorkouts();
    closeWorkoutModal();
  }

  function deleteWorkout(index) {
    const workouts = JSON.parse(localStorage.getItem('workouts') || '[]');
    workouts.splice(index, 1);
    localStorage.setItem('workouts', JSON.stringify(workouts));
    loadWorkouts();
  }

  // Attach form submit listeners
  document.getElementById('measurementForm').addEventListener('submit', saveMeasurement);
  document.getElementById('workoutForm').addEventListener('submit', saveWorkout);

  // Chart.js charts
  let weightChart, armChart, chestChart;
  function renderCharts() {
    const measurements = JSON.parse(localStorage.getItem('measurements') || '[]');

    // Sort by date ascending
    measurements.sort((a, b) => new Date(a.date) - new Date(b.date));

    const labels = measurements.map(m => m.date);
    const weightData = measurements.map(m => m.weight);
    const armData = measurements.map(m => m.arm);
    const chestData = measurements.map(m => m.chest);

    // Destroy previous charts if exist
    if(weightChart) weightChart.destroy();
    if(armChart) armChart.destroy();
    if(chestChart) chestChart.destroy();

    const ctxWeight = document.getElementById('weightChart').getContext('2d');
    weightChart = new Chart(ctxWeight, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: 'الوزن (كجم)',
          data: weightData,
          borderColor: '#d62828',
          backgroundColor: 'rgba(214, 40, 40, 0.2)',
          fill: true,
          tension: 0.3,
          pointRadius: 4,
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: false }
        }
      }
    });

    const ctxArm = document.getElementById('armChart').getContext('2d');
    armChart = new Chart(ctxArm, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: 'محيط الذراع (سم)',
          data: armData,
          borderColor: '#f77f00',
          backgroundColor: 'rgba(247, 127, 0, 0.2)',
          fill: true,
          tension: 0.3,
          pointRadius: 4,
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: false }
        }
      }
    });

    const ctxChest = document.getElementById('chestChart').getContext('2d');
    chestChart = new Chart(ctxChest, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: 'محيط الصدر (سم)',
          data: chestData,
          borderColor: '#003049',
          backgroundColor: 'rgba(0, 48, 73, 0.2)',
          fill: true,
          tension: 0.3,
          pointRadius: 4,
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: false }
        }
      }
    });
  }
</script>

</body>
</html>
